{"version":3,"sources":["pages/Live.module.css","pages/Live.js"],"names":["module","exports","defaultUrl","useEffect","createPlayer","id","url","document","createElement","canPlayType","Player","el","querySelector","pip","width","height","HlsPlugin","isSupported","isLive","plugins","_useState","useState","_useState2","_slicedToArray","liveUrl","setLiveUrl","_useState3","_useState4","liveOrder","setLiveOrder","_useState5","_useState6","maxLiveNum","setMaxLiveNum","React","className","style","liveContainer","Button","onClick","allLive","newLive","randomId","Math","random","toFixed","toString","slice","setAttribute","insertBefore","lastChild","length","Array","from","querySelectorAll","addOneLive","type","Input","onChange","e","target","value","marginLeft","addonBefore","concat","remove","InputNumber","v","max","min","addonAfter","defaultValue"],"mappings":"gGACAA,EAAOC,QAAU,CAAC,cAAgB,8B,2ICO5BC,EAAa,6CACJ,qBACbC,qBAAU,WAER,OADAC,EAAa,SAAUF,GAChB,eACN,IACH,IAAME,EAAe,SAAUC,EAAIC,GAU7BC,SAASC,cAAc,SAASC,YAAY,iCAE9C,IAAIC,IAAO,CACTC,GAAIJ,SAASK,cAAc,IAAMP,GACjCC,MACAO,KAAK,EACLC,MAAO,MACPC,OAAQ,SAEDC,IAAUC,eAEnB,IAAIP,IAAO,CACTC,GAAIJ,SAASK,cAAc,IAAMP,GACjCa,QAAQ,EACRZ,MACAO,KAAK,EACLM,QAAS,CAACH,KACVF,MAAO,MACPC,OAAQ,UAmBdK,EAA8BC,mBAASnB,GAAWoB,EAAAC,YAAAH,EAAA,GAA3CI,EAAOF,EAAA,GAAEG,EAAUH,EAAA,GAC1BI,EAAkCL,mBAAS,GAAEM,EAAAJ,YAAAG,EAAA,GAAtCE,EAASD,EAAA,GAAEE,EAAYF,EAAA,GAC9BG,EAAoCT,mBAAS,GAAEU,EAAAR,YAAAO,EAAA,GAAxCE,EAAUD,EAAA,GAAEE,EAAaF,EAAA,GAEhC,OACEG,IAAA1B,cAAA,OAAKH,GAAG,UAAU8B,UAAWC,IAAMC,eACjCH,IAAA1B,cAAA,OAAKH,GAAG,WACR6B,IAAA1B,cAAA,WACE0B,IAAA1B,cAAA,WACE0B,IAAA1B,cAAC8B,IAAM,CACLC,QAAS,YAzBA,SAAUjC,GAC3B,IAAMkC,EAAUjC,SAASK,cAAc,YACjC6B,EAAUlC,SAASC,cAAc,OACjCkC,EAAW,SAAWC,KAAKC,SAASC,QAAQ,GAAGC,WAAWC,MAAM,GACtEN,EAAQO,aAAa,KAAMN,GAC3BF,EAAQS,aAAaR,EAASD,EAAQU,WACtC9C,EAAasC,EAAUpC,GAEvB,IAAM6C,EAASC,MAAMC,KAAK9C,SAAS+C,iBAAiB,aAAaH,OACjElB,EAAckB,EAAS,GAiBbI,CAAW/B,IAEbgC,KAAK,WACN,8CAGDtB,IAAA1B,cAACiD,IAAK,CACJC,SAAU,SAACC,GACTlC,EAAWkC,EAAEC,OAAOC,QAEtBzB,MAAO,CAAEtB,MAAO,QAASgD,WAAY,QACrCC,YAAY,gCACZF,MAAOrC,KAGXU,IAAA1B,cAAA,WACE0B,IAAA1B,cAAC8B,IAAM,CAACC,QA/BM,WACThC,SAASK,cAAc,sBAADoD,OAAuBpC,EAAS,MAC9DqC,UA6BmCT,KAAK,WAAU,8CAG/CtB,IAAA1B,cAAC0D,IAAW,CACVR,SAAU,SAACS,GACTtC,EAAasC,IAEfC,IAAKpC,EACLqC,IAAK,EACLjC,MAAO,CAAEtB,MAAO,QAASgD,WAAY,QACrCC,YAAY,SACZO,WAAW,SACXT,MAAOjC,EACP2C,aAAa","file":"static/js/7.27803074.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"liveContainer\":\"Live_liveContainer__s2BoV\"};","import React, { useEffect, useState } from 'react';\r\nimport { Button, Input, InputNumber } from 'antd';\r\nimport FlvPlugin from 'xgplayer-flv';\r\nimport Player from 'xgplayer';\r\nimport HlsPlugin from 'xgplayer-hls';\r\nimport 'xgplayer/dist/index.min.css';\r\nimport style from './Live.module.css';\r\n\r\nconst defaultUrl = 'http://220.161.87.62:8800/hls/0/index.m3u8';\r\nexport default function () {\r\n  useEffect(() => {\r\n    createPlayer('player', defaultUrl);\r\n    return () => {};\r\n  }, []);\r\n  const createPlayer = function (id, url) {\r\n    //   if (FlvPlugin.isSupported()) {\r\n    //     // 第一步，检测当前环境是否支持\r\n    //     const player = new Player({\r\n    //       id: 'player',\r\n    //       url: 'test.flv', // flv 流地址\r\n    //       isLive: true,\r\n    //       plugins: [FlvPlugin], // 第二步\r\n    //     });\r\n    //  }\r\n    if (document.createElement('video').canPlayType('application/vnd.apple.mpegurl')) {\r\n      // 原生支持 hls 播放\r\n      new Player({\r\n        el: document.querySelector('#' + id),\r\n        url,\r\n        pip: true,\r\n        width: '50%',\r\n        height: '100%',\r\n      });\r\n    } else if (HlsPlugin.isSupported()) {\r\n      // 第一步，检测当前环境是否支持\r\n      new Player({\r\n        el: document.querySelector('#' + id),\r\n        isLive: true,\r\n        url, // hls 流地址\r\n        pip: true,\r\n        plugins: [HlsPlugin], // 第二步\r\n        width: '50%',\r\n        height: '100%',\r\n      });\r\n    }\r\n  };\r\n  const addOneLive = function (url) {\r\n    const allLive = document.querySelector('#allLive');\r\n    const newLive = document.createElement('div');\r\n    const randomId = 'player' + Math.random().toFixed(5).toString().slice(2);\r\n    newLive.setAttribute('id', randomId);\r\n    allLive.insertBefore(newLive, allLive.lastChild);\r\n    createPlayer(randomId, url);\r\n    // 设置最大可设置第几个删除直播间\r\n    const length = Array.from(document.querySelectorAll('#allLive')).length;\r\n    setMaxLiveNum(length - 2);\r\n  };\r\n  const deleteOneLive = function () {\r\n    const el = document.querySelector(`#allLive:nth-child(${liveOrder})`);\r\n    el.remove();\r\n  };\r\n  const [liveUrl, setLiveUrl] = useState(defaultUrl);\r\n  const [liveOrder, setLiveOrder] = useState(0);\r\n  const [maxLiveNum, setMaxLiveNum] = useState(1);\r\n\r\n  return (\r\n    <div id=\"allLive\" className={style.liveContainer}>\r\n      <div id=\"player\"></div>\r\n      <div>\r\n        <div>\r\n          <Button\r\n            onClick={() => {\r\n              addOneLive(liveUrl);\r\n            }}\r\n            type=\"primary\"\r\n          >\r\n            添加一个直播间\r\n          </Button>\r\n          <Input\r\n            onChange={(e) => {\r\n              setLiveUrl(e.target.value);\r\n            }}\r\n            style={{ width: '400px', marginLeft: '10px' }}\r\n            addonBefore=\"推流m3u8地址:\"\r\n            value={liveUrl}\r\n          />\r\n        </div>\r\n        <div>\r\n          <Button onClick={deleteOneLive} type=\"primary\">\r\n            删除一个直播间\r\n          </Button>\r\n          <InputNumber\r\n            onChange={(v) => {\r\n              setLiveOrder(v);\r\n            }}\r\n            max={maxLiveNum}\r\n            min={1}\r\n            style={{ width: '200px', marginLeft: '10px' }}\r\n            addonBefore=\"第\"\r\n            addonAfter=\"个\"\r\n            value={liveOrder}\r\n            defaultValue=\"0\"\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"sourceRoot":""}